Version 4
SHEET 1 5476 1600
WIRE 3184 -704 2752 -704
WIRE 4464 -704 3264 -704
WIRE 3072 -544 2816 -544
WIRE 3408 -544 3152 -544
WIRE 2816 -496 2816 -544
WIRE 2928 -496 2816 -496
WIRE 3264 -496 2992 -496
WIRE 3408 -496 3408 -544
WIRE 3408 -496 3344 -496
WIRE 2816 -432 2816 -496
WIRE 3072 -432 2816 -432
WIRE 3408 -432 3408 -496
WIRE 3408 -432 3136 -432
WIRE 4224 -432 3408 -432
WIRE 2816 -288 2816 -432
WIRE 3152 -288 2816 -288
WIRE 2160 -272 2128 -272
WIRE 2208 -272 2160 -272
WIRE 3408 -272 3216 -272
WIRE 2128 -256 2128 -272
WIRE 2544 -256 2416 -256
WIRE 3152 -256 2544 -256
WIRE 2416 -240 2416 -256
WIRE 3184 -240 3184 -256
WIRE 2208 -224 2208 -272
WIRE 2368 -224 2208 -224
WIRE 4464 -208 4464 -704
WIRE 4464 -208 4448 -208
WIRE 4672 -208 4464 -208
WIRE 4800 -208 4672 -208
WIRE 5072 -208 4800 -208
WIRE 3408 -192 3408 -272
WIRE 3616 -192 3408 -192
WIRE 3776 -192 3680 -192
WIRE 3856 -192 3856 -256
WIRE 4048 -192 3936 -192
WIRE 4224 -192 4224 -432
WIRE 4224 -192 4112 -192
WIRE 4368 -192 4368 -208
WIRE 4368 -192 4224 -192
WIRE 3616 -160 3408 -160
WIRE 4048 -160 3680 -160
WIRE 4224 -160 4112 -160
WIRE 4368 -160 4224 -160
WIRE 4368 -144 4368 -160
WIRE 4464 -144 4448 -144
WIRE 4672 -144 4464 -144
WIRE 4736 -144 4672 -144
WIRE 2752 -96 2752 -704
WIRE 2976 -96 2752 -96
WIRE 3408 -80 3408 -160
WIRE 3408 -80 3040 -80
WIRE 2544 -64 2416 -64
WIRE 2976 -64 2544 -64
WIRE 4736 -64 4736 -144
WIRE 4800 -64 4736 -64
WIRE 5072 -64 5072 -128
WIRE 5072 -64 4800 -64
WIRE 2208 -48 2208 -224
WIRE 2368 -48 2208 -48
WIRE 3008 -48 3008 -64
WIRE 2752 80 2752 -96
WIRE 3088 80 2752 80
WIRE 3408 80 3152 80
WIRE 4224 80 4224 -160
WIRE 4224 80 3408 80
WIRE 2752 144 2752 80
WIRE 2928 144 2752 144
WIRE 3264 144 2992 144
WIRE 3408 144 3408 80
WIRE 3408 144 3344 144
WIRE 2752 192 2752 144
WIRE 3056 192 2752 192
WIRE 3408 192 3408 144
WIRE 3408 192 3136 192
WIRE 2816 320 2816 -288
WIRE 3184 320 2816 320
WIRE 4464 320 4464 -144
WIRE 4464 320 3264 320
WIRE 3200 528 2768 528
WIRE 4480 528 3280 528
WIRE 3088 688 2832 688
WIRE 3424 688 3168 688
WIRE 2832 736 2832 688
WIRE 2944 736 2832 736
WIRE 3280 736 3008 736
WIRE 3424 736 3424 688
WIRE 3424 736 3360 736
WIRE 2832 800 2832 736
WIRE 3088 800 2832 800
WIRE 3424 800 3424 736
WIRE 3424 800 3152 800
WIRE 4224 800 3424 800
WIRE 2832 944 2832 800
WIRE 3168 944 2832 944
WIRE 2176 960 2144 960
WIRE 2224 960 2176 960
WIRE 3424 960 3232 960
WIRE 2144 976 2144 960
WIRE 2560 976 2432 976
WIRE 3168 976 2560 976
WIRE 2432 992 2432 976
WIRE 3200 992 3200 976
WIRE 2224 1008 2224 960
WIRE 2384 1008 2224 1008
WIRE 4480 1024 4480 528
WIRE 4480 1024 4464 1024
WIRE 4688 1024 4480 1024
WIRE 4816 1024 4688 1024
WIRE 5088 1024 4816 1024
WIRE 3424 1040 3424 960
WIRE 3632 1040 3424 1040
WIRE 3792 1040 3696 1040
WIRE 3824 1040 3792 1040
WIRE 3936 1040 3904 1040
WIRE 4064 1040 3936 1040
WIRE 4224 1040 4224 800
WIRE 4224 1040 4128 1040
WIRE 4384 1040 4384 1024
WIRE 4384 1040 4224 1040
WIRE 3632 1072 3424 1072
WIRE 4064 1072 3696 1072
WIRE 4224 1072 4128 1072
WIRE 4384 1072 4224 1072
WIRE 4384 1088 4384 1072
WIRE 4480 1088 4464 1088
WIRE 4688 1088 4480 1088
WIRE 4752 1088 4688 1088
WIRE 2768 1136 2768 528
WIRE 2992 1136 2768 1136
WIRE 3424 1152 3424 1072
WIRE 3424 1152 3056 1152
WIRE 2560 1168 2432 1168
WIRE 2992 1168 2560 1168
WIRE 4752 1168 4752 1088
WIRE 4816 1168 4752 1168
WIRE 5088 1168 5088 1104
WIRE 5088 1168 4816 1168
WIRE 2224 1184 2224 1008
WIRE 2384 1184 2224 1184
WIRE 3024 1184 3024 1168
WIRE 2768 1312 2768 1136
WIRE 3104 1312 2768 1312
WIRE 3424 1312 3168 1312
WIRE 4224 1312 4224 1072
WIRE 4224 1312 3424 1312
WIRE 2768 1376 2768 1312
WIRE 2944 1376 2768 1376
WIRE 3280 1376 3008 1376
WIRE 3424 1376 3424 1312
WIRE 3424 1376 3360 1376
WIRE 2768 1424 2768 1376
WIRE 3072 1424 2768 1424
WIRE 3424 1424 3424 1376
WIRE 3424 1424 3152 1424
WIRE 2832 1552 2832 944
WIRE 3200 1552 2832 1552
WIRE 4480 1552 4480 1088
WIRE 4480 1552 3280 1552
FLAG 3184 -384 0
FLAG 3184 -160 0
FLAG 3008 -192 0
FLAG 3008 32 0
FLAG 2128 -176 0
FLAG 2368 -176 0
FLAG 2368 0 0
FLAG 4672 -208 outp
FLAG 4672 -144 outn
FLAG 2544 -256 Vinpos
FLAG 2544 -64 Vinneg
FLAG 2160 -272 Vindiff
FLAG 2416 16 0
FLAG 2416 -160 0
FLAG 3856 -336 0
FLAG 3200 848 0
FLAG 3200 1072 0
FLAG 3024 1040 0
FLAG 3024 1264 0
FLAG 2144 1056 0
FLAG 2384 1056 0
FLAG 2384 1232 0
FLAG 4688 1024 outp2
FLAG 4688 1088 outn2
FLAG 2560 976 Vinpos2
FLAG 2560 1168 Vinneg2
FLAG 2176 960 Vindiff2
FLAG 2432 1248 0
FLAG 2432 1072 0
FLAG 3792 1040 VFM
FLAG 3936 1040 VIM
SYMBOL res 3280 -720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 4352 -192 R270
WINDOW 0 96 52 VTop 2
WINDOW 3 96 53 VBottom 2
SYMATTR InstName R5
SYMATTR Value 250
SYMBOL cap 3072 -416 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C7
SYMATTR Value {CFB}
SYMBOL res 5056 -224 R0
SYMATTR InstName RL
SYMATTR Value {RLOAD}
SYMBOL res 3168 -560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10250
SYMBOL res 3280 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R36
SYMATTR Value 10k
SYMBOL res 4464 -160 R90
WINDOW 0 70 55 VBottom 2
WINDOW 3 74 57 VTop 2
SYMATTR InstName R38
SYMATTR Value 250
SYMBOL cap 3152 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C10
SYMATTR Value {CFB}
SYMBOL res 3152 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R40
SYMATTR Value 10250
SYMBOL voltage 3184 -288 R180
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 15
SYMBOL voltage 3184 -256 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V7
SYMATTR Value -15
SYMBOL voltage 3008 -96 R180
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V8
SYMATTR Value 15
SYMBOL voltage 3008 -64 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V9
SYMATTR Value -15
SYMBOL voltage 2128 -272 R0
WINDOW 3 24 44 Left 2
WINDOW 123 24 72 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value 0.25
SYMATTR InstName V2
SYMBOL e 2416 -256 R0
SYMATTR InstName E3
SYMATTR Value .5
SYMBOL e 2416 -80 R0
SYMATTR InstName E4
SYMATTR Value -.5
SYMBOL AutoGenerated\\balun 3648 -176 M0
SYMATTR InstName U3
SYMBOL AutoGenerated\\balun 4080 -176 R0
SYMATTR InstName U4
SYMBOL voltage 3872 -192 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName VIF
SYMATTR Value 0
SYMBOL voltage 3840 -192 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
SYMATTR InstName VII
SYMATTR Value 0
SYMBOL current 3856 -336 R0
WINDOW 123 24 28 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value2 AC 1.
SYMATTR InstName I1
SYMATTR Value ""
SYMBOL res 3296 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 4368 1040 R270
WINDOW 0 96 52 VTop 2
WINDOW 3 96 53 VBottom 2
SYMATTR InstName R2
SYMATTR Value 250
SYMBOL cap 3088 816 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C1
SYMATTR Value {CFB}
SYMBOL res 5072 1008 R0
SYMATTR InstName RL1
SYMATTR Value {RLOAD}
SYMBOL res 3184 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10250
SYMBOL res 3296 1536 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res 4480 1072 R90
WINDOW 0 70 55 VBottom 2
WINDOW 3 74 57 VTop 2
SYMATTR InstName R7
SYMATTR Value 250
SYMBOL cap 3168 1296 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value {CFB}
SYMBOL res 3168 1408 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10250
SYMBOL voltage 3200 944 R180
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 15
SYMBOL voltage 3200 976 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value -15
SYMBOL voltage 3024 1136 R180
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value 15
SYMBOL voltage 3024 1168 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value -15
SYMBOL voltage 2144 960 R0
WINDOW 3 24 44 Left 2
WINDOW 123 24 72 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value 0.25
SYMATTR InstName V10
SYMBOL e 2432 976 R0
SYMATTR InstName E1
SYMATTR Value .5
SYMBOL e 2432 1152 R0
SYMATTR InstName E2
SYMATTR Value -.5
SYMBOL AutoGenerated\\balun 3664 1056 M0
SYMATTR InstName U7
SYMBOL AutoGenerated\\balun 4096 1056 R0
SYMATTR InstName U8
SYMBOL voltage 3920 1040 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 88 56 VTop 2
WINDOW 123 60 56 VTop 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V11
SYMATTR Value ""
SYMATTR Value2 AC 1
SYMBOL cap 4800 1024 R0
SYMATTR InstName C3
SYMATTR Value {CLOAD}
SYMBOL cap 4784 -208 R0
SYMATTR InstName C4
SYMATTR Value {CLOAD}
SYMBOL Opamps\\opamp2 3184 -336 R0
SYMATTR InstName U5
SYMATTR Value OPAMPMOD
SYMATTR Value2 AV={AOL} RO={ROUT} RIN={RIN} CIN={CIN} FP1={FP1} FP2={FP2} FP3={FP3}
SYMBOL Opamps\\opamp2 3008 -144 R0
SYMATTR InstName U6
SYMATTR Value OPAMPMOD
SYMATTR Value2 AV={AOL} RO={ROUT} RIN={RIN} CIN={CIN} FP1={FP1} FP2={FP2} FP3={FP3}
SYMBOL cap 2928 -480 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C5
SYMATTR Value {CFB2}
SYMBOL res 3360 -512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {RFB}
SYMBOL cap 2944 752 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C6
SYMATTR Value {CFB2}
SYMBOL res 3376 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value {RFB}
SYMBOL cap 2928 160 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C8
SYMATTR Value {CFB2}
SYMBOL res 3360 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value {RFB}
SYMBOL cap 2944 1392 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C9
SYMATTR Value {CFB2}
SYMBOL res 3376 1360 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value {RFB}
SYMBOL res 4784 -160 R0
SYMATTR InstName R14
SYMATTR Value {CLOADRSERIES}
SYMBOL res 4800 1072 R0
SYMATTR InstName R15
SYMATTR Value {CLOADRSERIES}
SYMBOL Opamps\\opamp2 3200 896 R0
SYMATTR InstName U1
SYMATTR Value OPAMPMOD
SYMATTR Value2 AV={AOL} RO={ROUT} RIN={RIN} CIN={CIN} FP1={FP1} FP2={FP2} FP3={FP3}
SYMBOL Opamps\\opamp2 3024 1088 R0
SYMATTR InstName U2
SYMATTR Value OPAMPMOD
SYMATTR Value2 AV={AOL} RO={ROUT} RIN={RIN} CIN={CIN} FP1={FP1} FP2={FP2} FP3={FP3}
TEXT 1128 816 Left 2 !.ac oct 10 1 100Meg
TEXT 3200 -648 Left 2 ;0.1%
TEXT 1128 856 Left 2 !;tran 0 10e-6 0 1e-9
TEXT 3216 584 Left 2 ;0.1%
TEXT 1168 32 Left 2 ;PLOT: \n \n((I(VIF)/I(VII))*(-V(VFM)/V(VIM))-1)/((I(VIF)/I(VII))+(-V(VFM)/V(VIM))+2)
TEXT 936 144 Left 2 !;op
TEXT 936 192 Left 2 ;.savebias "c:\\sim\\ltspice\\differential_howland_op_point.txt" internal
TEXT 936 240 Left 2 ;.loadbias "c:\\sim\\ltspice\\differential_howland_op_point.txt"
TEXT 944 288 Left 2 !.lib "c:\\sim\\op_amp_model.net
TEXT 968 368 Left 2 !* OP-AMP PARAMETERS\n.param RIN 10Meg\n.param CIN 10p\n.param ROUT 10\n.param AOL 1Meg\n.param GBW 10Meg\n.param FP1 {GBW / SQRT((AOL / 1.413)**2 - 1)}\n.param FP2 {GBW}\n.param FP3 {100*GBW}
TEXT 920 -632 Left 6 ;Differential Howland VCCS\nLoop gain simulation using Middlebrook method
TEXT 944 320 Left 2 !.lib "c:\\sim\\balun.net
TEXT 984 680 Left 2 !.param RLOAD 10k\n.param CLOAD 1u\n.param CLOADRSERIES 1E-3
TEXT 1040 928 Left 2 ;.param CFB 0
TEXT 1256 1000 Left 2 ;.step param GBW list 1Meg 5Meg 10Meg 50Meg 100Meg
TEXT 1264 960 Left 2 ;.step param CFB2 list 1f 1p 5p 10p 15p 50p
TEXT 1256 928 Left 2 !.step param CFB list 1f 5p 10p 100p 1n
TEXT 1024 968 Left 2 !.param CFB2 0p
TEXT 1264 984 Left 2 ;.step param RFB list 100 1k 5k 10k 15k 25k 50k 100k
TEXT 1024 1000 Left 2 !.param RFB 1
